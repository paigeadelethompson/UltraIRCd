# IRCd Hybrid

This repository contains the IRCd Hybrid IRC daemon and its vendored dependencies.

## Purpose

IRCd Hybrid is an advanced, lightweight Internet Relay Chat Daemon (ircd). This package includes vendored dependencies to simplify dependency management using Conan 2.0 for C/C++ dependency management.

## Documentation

- [Building Guide](BUILDING.md) - Instructions for building IRCd Hybrid
- [Development Notes](DEVELOPMENT.md) - Information for developers working on the codebase
- [License Information](COPYING.md) - License details for IRCd Hybrid
- [Authors](AUTHORS.md) - Contributors to the IRCd Hybrid project

## Development Notes

- The configuration file is in XML format with an XSD schema that is injected into the build for validation and modeling purposes, without introspection.
- The build system has been completely rewritten in CMake, utilizing Conan 2 for managing vendored dependencies.
- The current author and maintainer of this project is Paige Thompson (paige@paige.bio).
- This project is a fork of IRCd Hybrid, named Ultra (UltraIRCd).
- The historical AUTHORS.md file is maintained for reference, but this project is not going to be IRCd Hybrid.

## System Dependencies

Before building Ultra-IRCd, you need to install the following system dependencies:

### Debian/Ubuntu
```bash
sudo apt-get update
sudo apt-get install -y build-essential cmake git python3 python3-pip libssl-dev
```

### Fedora/RHEL/CentOS
```bash
sudo dnf install -y gcc gcc-c++ make cmake git python3 python3-pip openssl-devel
```

### Arch Linux
```bash
sudo pacman -S base-devel cmake git python python-pip openssl
```

### macOS
```bash
brew install cmake git python openssl
```

### FreeBSD
```bash
pkg install cmake git python3 py3-pip openssl
```
Note: FreeBSD uses Clang as its default compiler, so GCC is not required.

## Usage

To use this package:

1. Start a Hatch shell:
   ```
   hatch run shell
   ```

2. Create and change to the build directory:
   ```
   mkdir build && cd build
   ```

3. Install dependencies with Conan:

   For Debug build:
   ```
   conan install .. --output-folder=. --build=missing --profile:build=default --profile:host=default -s build_type=Debug
   ```

   For Release build:
   ```
   conan install .. --output-folder=. --build=missing --profile:build=default --profile:host=default -s build_type=Release
   ```

4. Configure with CMake:

   For Debug build:
   ```
   cmake .. -DCMAKE_TOOLCHAIN_FILE=build/Debug/generators/conan_toolchain.cmake -DCMAKE_BUILD_TYPE=Debug -DENABLE_DEBUGGING=ON
   ```

   For Release build:
   ```
   cmake .. -DCMAKE_TOOLCHAIN_FILE=build/Release/generators/conan_toolchain.cmake -DCMAKE_BUILD_TYPE=Release
   ```

## Configuration

IRCd Hybrid uses an XML-based configuration format. You can generate a default configuration file using the `-g` option:

```bash
ircd -g > ircd.xml
```

This will create a default configuration file that you can then customize for your specific needs.

### Example Configuration

Here's an example of a basic configuration file:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!--
 * ircd-hybrid configuration file
 * Generated by conf_generate_default
 *
 * This file contains all configuration options for the ircd-hybrid IRC server.
 * Edit this file to customize your server settings.
 *
 * For more information, see the documentation at:
 * https://github.com/ircd-hybrid/ircd-hybrid/wiki
 -->

<ircd xmlns="http://www.ultra-ircd.org/ircd">

  <!-- Module Base Path Configuration -->
  <module_base_path
    path="var/lib/modules"
  />

  <!-- Server Information -->
  <serverinfo
    name="irc.example.com"
    sid="001"
    description="Example IRC Server"
    network_name="Example Network"
    network_description="A network of IRC servers"
    default_max_clients="100"
    max_nick_length="30"
    max_topic_length="300"
    hub="no"
    motd_file="/etc/ircd-hybrid/motd"
    rsa_private_key_file="/etc/ircd-hybrid/ircd.key"
    tls_certificate_file="/etc/ircd-hybrid/ircd.crt"
    tls_dh_param_file="/etc/ircd-hybrid/dh.pem"
    tls_supported_groups="X25519:P-256:P-384"
    tls_cipher_list="ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384"
    tls_cipher_suites="TLS_AES_256_GCM-SHA384:TLS_CHACHA20_POLY1305_SHA256"
    tls_message_digest_algorithm="SHA256"
  />

  <!-- Admin Information -->
  <admin
    name="Example Admin"
    description="Example IRC Network Administrator"
    email="admin@example.com"
  />

  <!-- Class Configuration -->
  <class
    name="users"
    ping_time="90 seconds"
    connectfreq="60 seconds"
    max_number="100"
    sendq="1 megabyte"
    recvq="1 megabyte"
    max_channels="20"
    max_perip_local="3"
    max_perip_global="5"
    min_idle="30 minutes"
    max_idle="120 minutes"
    cidr_bitlen_ipv4="24"
    cidr_bitlen_ipv6="64"
    number_per_cidr="3"
    random_idle="yes"
    hide_idle_from_opers="no"
  />

  <class
    name="opers"
    ping_time="90 seconds"
    connectfreq="60 seconds"
    max_number="20"
    sendq="5 megabytes"
    recvq="5 megabytes"
    max_channels="100"
    max_perip_local="5"
    max_perip_global="10"
    min_idle="30 minutes"
    max_idle="120 minutes"
    cidr_bitlen_ipv4="24"
    cidr_bitlen_ipv6="64"
    number_per_cidr="5"
    random_idle="yes"
    hide_idle_from_opers="no"
  />

  <class
    name="servers"
    ping_time="90 seconds"
    connectfreq="60 seconds"
    max_number="10"
    sendq="10 megabytes"
    recvq="10 megabytes"
    max_channels="0"
    max_perip_local="0"
    max_perip_global="0"
    min_idle="30 minutes"
    max_idle="120 minutes"
    cidr_bitlen_ipv4="24"
    cidr_bitlen_ipv6="64"
    number_per_cidr="0"
    random_idle="yes"
    hide_idle_from_opers="no"
  />

  <!-- Channel Configuration -->
  <channel
    max_bans="100"
    max_bans_large="200"
    max_invites="100"
    max_kick_length="200"
    max_channels="20"
    invite_client_count="20"
    invite_client_time="60 seconds"
    invite_delay_channel="30 seconds"
    invite_expire_time="1 day"
    knock_client_count="20"
    knock_client_time="60 seconds"
    knock_delay_channel="30 seconds"
    default_join_flood_count="10"
    default_join_flood_time="10 seconds"
    disable_fake_channels="no"
    enable_extbans="yes"
    enable_owner="yes"
    enable_admin="yes"
  />

  <!-- Server Hiding Configuration -->
  <serverhide
    flatten_links="no"
    flatten_links_delay="30 seconds"
    flatten_links_file="/etc/ircd-hybrid/flatten_links.conf"
    disable_remote_commands="no"
    hide_servers="no"
    hide_services="no"
    hidden="no"
    hidden_name="irc.example.com"
    hide_server_ips="yes"
  />

  <!-- Logging Configuration -->
  <log use_logging="yes">
    <file
      name="stderr"
      type="user"
      severity="info"
      size="10 megabytes"
    />
    <file
      name="stderr"
      type="operator"
      severity="info"
      size="10 megabytes"
    />
    <file
      name="stderr"
      type="debug"
      severity="debug"
      size="10 megabytes"
    />
    <file
      name="stderr"
      type="xline"
      severity="info"
      size="10 megabytes"
    />
  </log>

</ircd>
```

## Requirements

- Python 3.8 or higher
- Conan 2.0 or higher

## License

This package is licensed under the same terms as ircd-hybrid. See [COPYING.md](COPYING.md) for details. 